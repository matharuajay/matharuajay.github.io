I"Ç&<p>Refactoring is very essential part of coding. You need to refactor your code, to give optimal result. Visual Studio have an inbuilt option for refactoring your code. Right click â€“ Refactor, today I am going to talk about Extract Method.</p>

<p>Suppose this is my sample code, althogh not good but just to demonstrate.</p>

<div style="font-family:Courier New;font-size:10pt;color:black;background:white;">
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 27</span>Â <span style="color:blue;">public</span> <span style="color:blue;">void</span> fillControl()
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 28</span>Â Â Â Â  {
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 29</span>Â Â Â Â  Â Â Â  <span style="color:blue;">try</span>
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 30</span>Â Â Â Â  Â Â Â  {
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 31</span>Â Â Â Â  Â Â Â  Â Â Â  <span style="color:#2b91af;">OleDbDataAdapter</span> adapter;
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 32</span>Â Â Â Â  Â Â Â  Â Â Â  <span style="color:#2b91af;">DataSet</span> dataset;
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 33</span>Â Â Â Â  Â Â Â  Â Â Â  <span style="color:#2b91af;">OleDbConnection</span> conn;
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 34</span>Â 
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 35</span>Â Â Â Â  Â Â Â  Â Â Â  conn = <span style="color:blue;">new</span> <span style="color:#2b91af;">OleDbConnection</span>();
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 36</span>Â Â Â Â  Â Â Â  Â Â Â  conn.ConnectionString = <span style="color:#a31515;">&#8220;PROVIDER=MICROSOFT.Jet.Oledb.4.0;Data Source=&#8221;</span> + Server.MapPath(<span style="color:#a31515;">&#8220;mydatabase.mdb&#8221;</span>);
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 37</span>Â 
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 38</span>Â Â Â Â  Â Â Â  Â Â Â  <span style="color:blue;">string</span> sqlQuery = <span style="color:#a31515;">&#8220;SELECT * from employee&#8221;</span>;
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 39</span>Â Â Â Â  Â Â Â  Â Â Â  adapter = <span style="color:blue;">new</span> <span style="color:#2b91af;">OleDbDataAdapter</span>(sqlQuery, conn);
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 40</span>Â Â Â Â  Â Â Â  Â Â Â  dataset = <span style="color:blue;">new</span> <span style="color:#2b91af;">DataSet</span>();
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 41</span>Â Â Â Â  Â Â Â  Â Â Â  adapter.Fill(dataset);
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 42</span>Â 
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 43</span>Â Â Â Â  Â Â Â  Â Â Â  datagrid1.DataSource = dataset;
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 44</span>Â Â Â Â  Â Â Â  Â Â Â  datagrid1.DataBind();
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 45</span>Â Â Â Â  Â Â Â  }
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 46</span>Â Â Â Â  Â Â Â  <span style="color:blue;">catch</span> (<span style="color:#2b91af;">Exception</span> ex)
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 47</span>Â Â Â Â  Â Â Â  {
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 48</span>Â Â Â Â  Â Â Â  Â Â Â  Response.Write(<span style="color:#a31515;">&#8220;ERROR :: &#8220;</span> + ex.Message);
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 49</span>Â Â Â Â  Â Â Â  }
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 50</span>Â Â Â Â  }
  </p>
  
  <p style="margin:0;">
    Â 
  </p>
  
  <p style="margin:0;">
    In this code you can see there is connection object created. But there may be numerous occasions where I&#8217;ll have to use the connection, so rather than writing this code again at that place, what I&#8217;ll do is just simply select the two lines of connection right click &#8211; refactor &#8211; extract method
  </p>
  
  <p style="margin:0;">
    Â 
  </p>
  
  <p style="margin:0;">
    <a href="http://ajaymatharu.files.wordpress.com/2008/11/extract-method1.png"></a><a href="http://ajaymatharu.files.wordpress.com/2008/11/extractmethod.jpg"><img class="aligncenter size-full wp-image-497" title="extractmethod" src="http://ajaymatharu.files.wordpress.com/2008/11/extractmethod.jpg" alt="extractmethod" width="500" height="374" /></a><a href="http://ajaymatharu.files.wordpress.com/2008/11/extract-method.png"></a>
  </p>
</div>

<p><a href="http://ajaymatharu.files.wordpress.com/2008/11/name.jpg"><img class="aligncenter size-full wp-image-498" title="name" src="http://ajaymatharu.files.wordpress.com/2008/11/name.jpg" alt="name" width="500" height="196" /></a></p>

<p>After this, all you get is extracted method,</p>

<div style="font-family:Courier New;font-size:10pt;color:black;background:white;">
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 27</span>Â <span style="color:blue;">public</span> <span style="color:blue;">void</span> fillControl()
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 28</span>Â Â Â Â  {
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 29</span>Â Â Â Â  Â Â Â  <span style="color:blue;">try</span>
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 30</span>Â Â Â Â  Â Â Â  {
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 31</span>Â Â Â Â  Â Â Â  Â Â Â  <span style="color:#2b91af;">OleDbDataAdapter</span> adapter;
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 32</span>Â Â Â Â  Â Â Â  Â Â Â  <span style="color:#2b91af;">DataSet</span> dataset;
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 33</span>Â Â Â Â  Â Â Â  Â Â Â  <span style="color:#2b91af;">OleDbConnection</span> conn;
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 34</span>Â 
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 35</span>Â Â Â Â  Â Â Â  Â Â Â  conn = ConnectDb();
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 36</span>Â 
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 37</span>Â Â Â Â  Â Â Â  Â Â Â  <span style="color:blue;">string</span> sqlQuery = <span style="color:#a31515;">&#8220;SELECT * from employee&#8221;</span>;
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 38</span>Â Â Â Â  Â Â Â  Â Â Â  adapter = <span style="color:blue;">new</span> <span style="color:#2b91af;">OleDbDataAdapter</span>(sqlQuery, conn);
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 39</span>Â Â Â Â  Â Â Â  Â Â Â  dataset = <span style="color:blue;">new</span> <span style="color:#2b91af;">DataSet</span>();
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 40</span>Â Â Â Â  Â Â Â  Â Â Â  adapter.Fill(dataset);
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 41</span>Â 
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 42</span>Â Â Â Â  Â Â Â  Â Â Â  datagrid1.DataSource = dataset;
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 43</span>Â Â Â Â  Â Â Â  Â Â Â  datagrid1.DataBind();
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 44</span>Â Â Â Â  Â Â Â  }
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 45</span>Â Â Â Â  Â Â Â  <span style="color:blue;">catch</span> (<span style="color:#2b91af;">Exception</span> ex)
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 46</span>Â Â Â Â  Â Â Â  {
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 47</span>Â Â Â Â  Â Â Â  Â Â Â  Response.Write(<span style="color:#a31515;">&#8220;ERROR :: &#8220;</span> + ex.Message);
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 48</span>Â Â Â Â  Â Â Â  }
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 49</span>Â Â Â Â  }
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 50</span>Â 
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 51</span>Â Â Â Â  <span style="color:blue;">private</span> <span style="color:#2b91af;">OleDbConnection</span> ConnectDb()
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 52</span>Â Â Â Â  Â Â Â  {
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 53</span>Â Â Â Â  Â Â Â  <span style="color:#2b91af;">OleDbConnection</span> conn;
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 54</span>Â Â Â Â  Â Â Â  conn = <span style="color:blue;">new</span> <span style="color:#2b91af;">OleDbConnection</span>();
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 55</span>Â Â Â Â  Â Â Â  conn.ConnectionString = <span style="color:#a31515;">&#8220;PROVIDER=MICROSOFT.Jet.Oledb.4.0;Data Source=&#8221;</span> + Server.MapPath(<span style="color:#a31515;">&#8220;mydatabase.mdb&#8221;</span>);
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 56</span>Â Â Â Â  Â Â Â  <span style="color:blue;">return</span> conn;
  </p>
  
  <p style="margin:0;">
    <span style="color:#2b91af;">Â Â Â 57</span>Â Â Â Â  Â Â Â  }
  </p>
  
  <p style="margin:0;">
    Â 
  </p>
  
  <p style="margin:0;">
    So now you can use this ConnectDb() function where ever you need to use the Database connection.
  </p>
</div>
:ET